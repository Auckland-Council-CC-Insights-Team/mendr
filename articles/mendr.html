<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>mendr • mendr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="mendr">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mendr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/mendr.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Auckland-Council-CC-Insights-Team/mendr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>mendr</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Auckland-Council-CC-Insights-Team/mendr/blob/master/vignettes/mendr.Rmd" class="external-link"><code>vignettes/mendr.Rmd</code></a></small>
      <div class="d-none name"><code>mendr.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Auckland-Council-CC-Insights-Team/mendr" class="external-link">mendr</a></span><span class="op">)</span></span></code></pre></div>
<p>The goal of mendr is to simplify the task of creating a calendar of
dates for a recurring process.</p>
<p>A typical use case for this is to import the data produced by
<code>mendr</code> into Microsoft Planner via a Power Automate Flow. We
describe this process below.</p>
<p>First, let’s create a dataset. Here we need a list of tasks, and for
each task an offset relative to the first working day of the month. We
count using index zero, so the first working day of the month is 0, the
second working day of the month is 1 and so on. We can also work
backwards: -1 is the first working day prior to the first working day of
the month.</p>
<p>After creating the dataset, we call <code><a href="../reference/create_calendar.html">create_calendar()</a></code> in
order to store a calendar of non-working days that will be used to
calculate the appropriate dates for our schedule. By default, this
stores known non-working days for Auckland Council staff from Labour Day
2022 to Labour Day 2024.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">tasks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>   tasks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Send email reminder"</span>, <span class="st">"Extract data"</span>, <span class="st">"Run report"</span><span class="op">)</span>,</span>
<span>   offsets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>   <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/create_calendar.html">create_calendar</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Although we manually created the data here, we would typically store
this in an Excel spreadsheet and read it using the <a href="https://readxl.tidyverse.org/" class="external-link">readxl</a> package.</p>
<p>Next, let’s convert our offsets into actual dates for the first three
months of 2023.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">schedule</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_schedule.html">create_schedule</a></span><span class="op">(</span></span>
<span>  schedule_data <span class="op">=</span> <span class="va">tasks</span>,</span>
<span>  starting_month <span class="op">=</span> <span class="st">"2023-01"</span>,</span>
<span>  iterations <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">schedule</span></span>
<span><span class="co">#&gt;                 tasks offsets       date</span></span>
<span><span class="co">#&gt; 1 Send email reminder      -2 2022-12-22</span></span>
<span><span class="co">#&gt; 2        Extract data       0 2023-01-09</span></span>
<span><span class="co">#&gt; 3          Run report       1 2023-01-10</span></span>
<span><span class="co">#&gt; 4 Send email reminder      -2 2023-01-27</span></span>
<span><span class="co">#&gt; 5        Extract data       0 2023-02-01</span></span>
<span><span class="co">#&gt; 6          Run report       1 2023-02-02</span></span>
<span><span class="co">#&gt; 7 Send email reminder      -2 2023-02-27</span></span>
<span><span class="co">#&gt; 8        Extract data       0 2023-03-01</span></span>
<span><span class="co">#&gt; 9          Run report       1 2023-03-02</span></span></code></pre></div>
<p>We can pass the optional <code>filepath</code> argument to
<code>create_schedule</code> too, and this saves the output to an Excel
file. Assuming we’ve done so, we can now reference that file in our
Power Automate flow.</p>
<p>To progress, we first create a new Plan in Microsoft Planner.</p>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lee Durbin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
